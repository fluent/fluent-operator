{{- if .Values.Kubernetes -}}
{{- if or .Values.fluentd.enable .Values.fluentd.enabled -}}
{{- if or .Values.fluentd.output.kafka.enable .Values.fluentd.output.kafka.enabled -}}
apiVersion: fluentd.fluent.io/v1alpha1
kind: ClusterFilter
metadata:
  name: fluentd-filter
  labels:
    filter.fluentd.fluent.io/enabled: "true"
spec:
  filters:
    - recordTransformer:
        enableRuby: true
        records:
          - key: {{ .Values.fluentd.output.kafka.topicKey }}
            value: ${record["kubernetes"]["namespace_name"]
{{- end }}
{{- end }}
{{- end }}